# In-depth Analysis of the Effects of Electromagnetic Fault Injection Attack on a 32-bit MCU阅读笔记

本文中使用的MCU是stm32f103zet6 enhanced MCU，LQFP144 封装，包含一颗32bit的Cortex-M.

测试代码为

``````c
printf("Start\r\n");
while(1){
    long long int a=0;
    for(int i=0;i<255;i++){
       for(int j=0;j<255;j++){
           a++;
       }
    }
    printf("ss %ll",a);
    printf("\n");
}
/*correct output:
Start
ss 65025
*/
``````

实验中，MCU被分为60*60的小格子，探针按照0.33cm的步长依次进行注入，最终得到注入结果和对应的位置。

论文中的结果可以很明显的看出故障类型和注入位置有很大关系。

而注入结果大致可分为3类：错误字符输出、程序重启以及计算错误。

错误字符输出比较容易理解，可以认为是printf导致的，0-p 00110000-01110000，6-v 00110110-01110110，5-u 00110101-01110101，space-$ 00100000-00100100

程序重启是由于EM干扰了Vdd导致芯片复位。

计算错误可以细分为65024 65026 >65026 <64770(<65024??????)四种情况。

65024：指令跳过或+1时的立即数由1翻到了0，或j由+1变成了+2。由于指令跳过是通过影响PC计数器来实现的，且PC寄存器为奇数时会出现异常，但实验中又没有出现异常，因此排除是指令跳过（存疑？？？）。由1变2翻转了两位，而由1变0只翻转了1位，更容易实现。因此推断是adds a,a,#1变成了adds,a,a,#0

65026:同理，adds j,j.#1变成了adds j,j,#0

<65024(<64770)个人认为介于二者之间，是多次指令跳过导致的，小于64770是内循环BLT跳转指令被跳过了导致的。

\>65026 MOV指令没有被正确执行，立即数不是0，导致a初值不是0。

?????????????????????????为什么不能用指令跳过解释？